
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>cnmodel.util package &#8212; CNModel 0.2 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="cnmodel.protocols package" href="protocols.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="protocols.html" title="cnmodel.protocols package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CNModel 0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" accesskey="U">API Reference</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cnmodel-util-package">
<h1>cnmodel.util package<a class="headerlink" href="#cnmodel-util-package" title="Permalink to this headline">¶</a></h1>
<p>Utility routines used within cnmodel</p>
<span class="target" id="module-cnmodel.util"></span><div class="section" id="cnmodel-util-params">
<h2>cnmodel.util.Params<a class="headerlink" href="#cnmodel-util-params" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.Params.</code><code class="descname">ParamTests</code><span class="sig-paren">(</span><em>methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/Params.html#ParamTests"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.case.TestCase</span></code></p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p>
<dl class="method">
<dt>
<code class="descname">setUp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/Params.html#ParamTests.setUp"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Hook method for setting up the test fixture before exercising it.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.Params.</code><code class="descname">Params</code><span class="sig-paren">(</span><em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/Params.html#Params"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Utility class to create parameter lists
create using:
p = Params(abc=2.0, defg = 3.0, lunch=’sandwich’)
reference using:
p.abc, p.defg, etc.
Supports getting the keys, finding whether a key exists, returning the strucure as a simple dictionary,
and printing (show) the parameter structure.</p>
<dl class="method">
<dt>
<code class="descname">additem</code><span class="sig-paren">(</span><em>key</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/Params.html#Params.additem"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">getkeys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/Params.html#Params.getkeys"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Get the keys in the current dictionary</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">haskey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/Params.html#Params.haskey"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Find out if the param list has a specific key in it</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">show</code><span class="sig-paren">(</span><em>printFlag=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/Params.html#Params.show"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>print the parameter block created in Parameter Init</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">todict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/Params.html#Params.todict"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>convert param list to standard dictionary
Useful when writing the data</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="cnmodel-util-ccstim">
<h2>cnmodel.util.ccstim<a class="headerlink" href="#cnmodel-util-ccstim" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.ccstim.</code><code class="descname">ccstim</code><span class="sig-paren">(</span><em>stim</em>, <em>dt</em>, <em>pulsetype='square'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/ccstim.html#ccstim"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create stimulus pulse waveforms of different types.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stim</strong> (<em>dict</em>) – a dictionary with keys [required]
delay (delay to start of pulse train, msec [all]
duration: duration of pulses in train, msec [all]
Sfreq: stimulus train frequency (Hz) [timedSpikes]
PT: post-train test delay [all]
NP: number of pulses in the train [timedSpikes, exp]
amp: amplitude of the pulses in the train [all]
hypamp: amplitude of prehyperpolarizing pulse [hyp]
hypdur: duration of prehyperpolarizing pulse [hyp]
spikeTimes” times of spikes [timedSpikes]</li>
<li><strong>dt</strong> (<em>time</em><em> (</em><em>microseconds</em><em>) </em><em>[</em><em>required</em><em>]</em>) – step time, in microseconds. Required parameter</li>
<li><strong>pulsetype</strong> (<em>string</em><em> (</em><em>default: 'square'</em><em>)</em>) – Type of pulse to generate: one of square, hyp, timedspikes or exp
square produces a train of “square” (retangular) pulses levels 0 and ampitude
hyp is like square, but precedes the pulse train with a single prepulse
of hypamp and hypdur
timedspikes is like square, excpet the pulses are generated at times specified
in the spikeTimes key in the stim dictionary
exp: pulses with an exponential decay.</li>
<li><strong>DO</strong> (<em>TO</em>) – add pulsetypes, including sine wave, rectified sine wave, etc.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">maxtime(float),
timebase (numpy array)]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list containing [waveform (numpy array),</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="cnmodel-util-expfitting">
<h2>cnmodel.util.expfitting<a class="headerlink" href="#cnmodel-util-expfitting" title="Permalink to this headline">¶</a></h2>
<p>expfitting.py
Provide single or double exponential fits to data.</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.expfitting.</code><code class="descname">ExpFitting</code><span class="sig-paren">(</span><em>nexp=1</em>, <em>initpars=None</em>, <em>bounds=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/expfitting.html#ExpFitting"><span class="viewcode-link">[source]</span></a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nexp</strong> (<em>int</em>) – 1 or 2 for single or double exponential fit</li>
<li><strong>initpars</strong> (<em>dict</em>) – dict of initial parameters. For example: {‘dc’: 0.,
‘a1’: 1., ‘t1’: 3, ‘a2’ : 0.5, ‘delta’: 3.}, where
delta determines the ratio between the time constants.</li>
<li><strong>bounds</strong> (<em>dict</em>) – dictionary of bounds for each parameter, with a list of lower and upper values.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="staticmethod">
<dt>
<em class="property">static </em><code class="descname">exp1</code><span class="sig-paren">(</span><em>dc</em>, <em>t1</em>, <em>a1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/expfitting.html#ExpFitting.exp1"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">exp1_err</code><span class="sig-paren">(</span><em>p</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/expfitting.html#ExpFitting.exp1_err"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt>
<em class="property">static </em><code class="descname">exp2</code><span class="sig-paren">(</span><em>dc</em>, <em>t1</em>, <em>a1</em>, <em>a2</em>, <em>delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/expfitting.html#ExpFitting.exp2"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">exp2_err</code><span class="sig-paren">(</span><em>p</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/expfitting.html#ExpFitting.exp2_err"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">fit</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>p</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/expfitting.html#ExpFitting.fit"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="cnmodel-util-filelock">
<h2>cnmodel.util.filelock<a class="headerlink" href="#cnmodel-util-filelock" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.filelock.</code><code class="descname">FileLock</code><span class="sig-paren">(</span><em>file_name</em>, <em>timeout=10</em>, <em>delay=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/filelock.html#FileLock"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A file locking mechanism that has context-manager support so
you can use it in a with statement. This should be relatively cross
compatible as it doesn’t rely on msvcrt or fcntl for the locking.</p>
<p>Prepare the file locker. Specify the file to lock and optionally
the maximum timeout and the delay between each attempt to lock.</p>
<dl class="method">
<dt>
<code class="descname">acquire</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/filelock.html#FileLock.acquire"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Acquire the lock, if possible. If the lock is in use, it check again
every <cite>wait</cite> seconds. It does this until it either gets the lock or
exceeds <cite>timeout</cite> number of seconds, in which case it throws
an exception.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">lock_count</code><em class="property"> = {}</em></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">lock_handles</code><em class="property"> = {}</em></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/filelock.html#FileLock.release"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Get rid of the lock by deleting the lockfile.
When working in a <cite>with</cite> statement, this gets automatically
called at the end.</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt>
<em class="property">exception </em><code class="descclassname">cnmodel.util.filelock.</code><code class="descname">FileLockException</code><a class="reference internal" href="_modules/cnmodel/util/filelock.html#FileLockException"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

</div>
<div class="section" id="cnmodel-util-find-point">
<h2>cnmodel.util.find_point<a class="headerlink" href="#cnmodel-util-find-point" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.find_point.</code><code class="descname">find_crossing</code><span class="sig-paren">(</span><em>data</em>, <em>start=0</em>, <em>direction=1</em>, <em>threshold=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/find_point.html#find_crossing"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the index at which <em>data</em> crosses <em>threshold</em>, starting
at index <em>start</em> and proceeding in <em>direction</em> (+/-1).</p>
<p>The value returned is a float indicating the interpolated index
position where the data crosses threshold, or NaN if the threshold was
never crossed.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.find_point.</code><code class="descname">find_point</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>peakindex</em>, <em>val</em>, <em>direction='left'</em>, <em>limits=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/find_point.html#find_point"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Given a waveform defined by <em>x</em> and <em>y</em> arrays, return the first time
at which the waveform crosses (y[peakindex] * val). The search begins at
<em>peakindex</em> and proceeds in <em>direction</em>.</p>
<p>Optionally, <em>limits</em> may specify a smaller search region in the form of
(t0, t1, dt).</p>
</dd></dl>

</div>
<div class="section" id="cnmodel-util-fitting">
<h2>cnmodel.util.fitting<a class="headerlink" href="#cnmodel-util-fitting" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.fitting.</code><code class="descname">Exp1</code><a class="reference internal" href="_modules/cnmodel/util/fitting.html#Exp1"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">cnmodel.util.fitting.FitModel</span></code></p>
<p>Single exponential fitting model.</p>
<p>Parameters are xoffset, yoffset, amp, and tau.</p>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.fitting.</code><code class="descname">Exp2</code><a class="reference internal" href="_modules/cnmodel/util/fitting.html#Exp2"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">cnmodel.util.fitting.FitModel</span></code></p>
<p>Double exponential fitting model.</p>
<p>Parameters are xoffset, yoffset, amp1, tau1, amp2, and tau2.</p>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.fitting.</code><code class="descname">FitExplorer</code><span class="sig-paren">(</span><em>model</em>, <em>fit</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/fitting.html#FitExplorer"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">PyQt5.QtWidgets.QWidget</span></code></p>
<dl class="method">
<dt>
<code class="descname">update_plots</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/fitting.html#FitExplorer.update_plots"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.fitting.</code><code class="descname">FitModel</code><span class="sig-paren">(</span><em>func</em>, <em>independent_vars=None</em>, <em>param_names=None</em>, <em>missing='none'</em>, <em>prefix=''</em>, <em>name=None</em>, <em>**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/fitting.html#FitModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.Model</span></code></p>
<p>Simple extension of lmfit.Model that allows one-line fitting.</p>
<p>Example uses:</p>
<p># single exponential fit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span> <span class="o">=</span> <span class="n">expfitting</span><span class="o">.</span><span class="n">Exp1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">time_vals</span><span class="p">,</span>
    <span class="n">xoffset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fixed&#39;</span><span class="p">),</span>
    <span class="n">yoffset</span><span class="o">=</span><span class="p">(</span><span class="n">yoff_guess</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">amp</span><span class="o">=</span><span class="p">(</span><span class="n">amp_guess</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
    <span class="n">tau</span><span class="o">=</span><span class="p">(</span><span class="n">tau_guess</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
</pre></div>
</div>
<p># plot the fit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fit_curve</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">plot</span><span class="p">(</span><span class="n">time_vals</span><span class="p">,</span> <span class="n">fit_curve</span><span class="p">)</span>
</pre></div>
</div>
<p># double exponential fit with tau ratio constraint
# note that ‘tau_ratio’ does not appear in the exp2 model;
# we can define new parameters here.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span> <span class="o">=</span> <span class="n">expfitting</span><span class="o">.</span><span class="n">Exp2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">time_vals</span><span class="p">,</span>
        <span class="n">xoffset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fixed&#39;</span><span class="p">),</span>
        <span class="n">yoffset</span><span class="o">=</span><span class="p">(</span><span class="n">yoff_guess</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">amp1</span><span class="o">=</span><span class="p">(</span><span class="n">amp_guess</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="n">tau1</span><span class="o">=</span><span class="p">(</span><span class="n">tau_guess</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="n">amp2</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">tau_ratio</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="n">tau2</span><span class="o">=</span><span class="s1">&#39;tau1 * tau_ratio&#39;</span>
        <span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>func</strong> (<em>callable</em>) – Function to be wrapped.</li>
<li><strong>independent_vars</strong> (<em>list of str</em><em>, </em><em>optional</em>) – Arguments to func that are independent variables (default is None).</li>
<li><strong>param_names</strong> (<em>list of str</em><em>, </em><em>optional</em>) – Names of arguments to func that are to be made into parameters
(default is None).</li>
<li><strong>missing</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>How to handle NaN and missing values in data. One of:</p>
<ul>
<li>’none’ or None : Do not check for null or missing values (default).</li>
<li>’drop’ : Drop null or missing observations in data. If pandas is
installed, <cite>pandas.isnull</cite> is used, otherwise <cite>numpy.isnan</cite> is used.</li>
<li>’raise’ : Raise a (more helpful) exception when data contains
null or missing values.</li>
</ul>
</li>
<li><strong>prefix</strong> (<em>str</em><em>, </em><em>optional</em>) – Prefix used for the model.</li>
<li><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name for the model. When None (default) the name is the same as
the model function (<cite>func</cite>).</li>
<li><strong>**kws</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional keyword arguments to pass to model function.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>1. Parameter names are inferred from the function arguments,
and a residual function is automatically constructed.</p>
<p>2. The model function must return an array that will be the same
size as the data being modeled.</p>
<p class="rubric">Examples</p>
<p>The model function will normally take an independent variable (generally,
the first argument) and a series of arguments that are meant to be
parameters for the model.  Thus, a simple peak using a Gaussian
defined as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">cen</span><span class="p">,</span> <span class="n">wid</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">cen</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">wid</span><span class="p">)</span>
</pre></div>
</div>
<p>can be turned into a Model with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gmodel</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">gaussian</span><span class="p">)</span>
</pre></div>
</div>
<p>this will automatically discover the names of the independent variables
and parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">gmodel</span><span class="o">.</span><span class="n">param_names</span><span class="p">,</span> <span class="n">gmodel</span><span class="o">.</span><span class="n">independent_vars</span><span class="p">)</span>
<span class="go">[&#39;amp&#39;, &#39;cen&#39;, &#39;wid&#39;], [&#39;x&#39;]</span>
</pre></div>
</div>
<dl class="method">
<dt>
<code class="descname">fit</code><span class="sig-paren">(</span><em>data</em>, <em>interactive=False</em>, <em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/fitting.html#FitModel.fit"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a fit of data to this model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>array</em>) – dependent data to fit</li>
<li><strong>interactive</strong> (<em>bool</em>) – If True, show a GUI used for interactively exploring fit parameters</li>
<li><strong>keyword arguments are passed to make_params</strong><strong>(</strong><strong>) </strong><strong>if they are model</strong> (<em>Extra</em>) – </li>
<li><strong>names</strong><strong>, or </strong><strong>passed directly to Model.fit</strong><strong>(</strong><strong>) </strong><strong>for independent</strong> (<em>parameter</em>) – </li>
<li><strong>names.</strong> (<em>variable</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">fit of data to model as an lmfit object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">make_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/fitting.html#FitModel.make_params"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Make parameters used for fitting with this model.</p>
<p>Keyword arguments are used to generate parameters for the fit. Each
parameter may be specified by the following formats:</p>
<dl class="docutils">
<dt>param=value :</dt>
<dd>The initial value of the parameter</dd>
<dt>param=(value, ‘fixed’) :</dt>
<dd>Fixed value for the parameter</dd>
<dt>param=(value, min, max) :</dt>
<dd>Initial value and min, max values, which may be float or None</dd>
<dt>param=’expression’ :</dt>
<dd>Expression used to compute parameter value. See:
<a class="reference external" href="http://lmfit.github.io/lmfit-py/constraints.html#constraints-chapter">http://lmfit.github.io/lmfit-py/constraints.html#constraints-chapter</a></dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">show_interactive</code><span class="sig-paren">(</span><em>fit=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/fitting.html#FitModel.show_interactive"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Show an interactive GUI for exploring fit parameters.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.fitting.</code><code class="descname">exp1</code><span class="sig-paren">(</span><em>x</em>, <em>xoffset</em>, <em>yoffset</em>, <em>tau</em>, <em>amp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/fitting.html#exp1"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.fitting.</code><code class="descname">exp2</code><span class="sig-paren">(</span><em>x</em>, <em>xoffset</em>, <em>yoffset</em>, <em>tau1</em>, <em>amp1</em>, <em>tau2</em>, <em>amp2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/fitting.html#exp2"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

</div>
<div class="section" id="cnmodel-util-get-anspikes">
<h2>cnmodel.util.get_anspikes<a class="headerlink" href="#cnmodel-util-get-anspikes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.get_anspikes.</code><code class="descname">ManageANSpikes</code><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>ManageANSpikes is a class to read the output of the Zilany et al. 2009 AN model into
python, and provides services to access that data.</p>
<p>Basic usage is to create an instance of the class, and specify the data directory
if necessary.</p>
<p>You may then get the data in the format of a list using one of the “get” routines.
The data is pulled from the nearest CF or the specified CF.</p>
<dl class="method">
<dt>
<code class="descname">combine_reps</code><span class="sig-paren">(</span><em>spkl</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.combine_reps"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Just turns the spike list into one big linear sequence.
:param spkl: a spike train (nreps of numpy arrays)
:return: all the spikes in one long array.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">display</code><span class="sig-paren">(</span><em>spkl</em>, <em>k</em>, <em>n</em>, <em>mg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.display"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">flatten</code><span class="sig-paren">(</span><em>sequence</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.flatten"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns a single, flat list which contains all elements retrieved
from the sequence and all recursively contained sub-sequences
(iterables).</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">getANatFandSPL</code><span class="sig-paren">(</span><em>spontclass='MS'</em>, <em>freq=10000.0</em>, <em>CF=None</em>, <em>SPL=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.getANatFandSPL"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Get the AN data at a particular frequency and SPL. Note that the tone freq is specified,
but the CF of the fiber might be different. If CF is None, we try to get the closest
fiber data to the tone Freq.
Other arguments are the spontaneous rate and the SPL level.
The data must exist, or we epically fail.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spontclass</strong> – ‘HS’, ‘MS’, or ‘LS’ for high, middle or low spont groups (1,2,3 in Zilany et al model)</li>
<li><strong>freq</strong> – The stimulus frequency, in Hz</li>
<li><strong>CF</strong> – The ‘characteristic frequency’ of the desired AN fiber, in Hz</li>
<li><strong>SPL</strong> – The sound pressure level, in dB SPL for the stimulus</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">an array of nReps of spike times.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">getANatSPL</code><span class="sig-paren">(</span><em>spl=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.getANatSPL"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">get_AN_at_SPL</code><span class="sig-paren">(</span><em>spl=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.get_AN_at_SPL"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>grabs the AN data for the requested SPL for the data set currently loaded
The data must exist, or we epically fail.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>spl</strong> – sound pressure level, in dB SPL</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">spike trains (times) as a list of nReps numpy arrays.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_AN_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.get_AN_info"><span class="viewcode-link">[source]</span></a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Dictionary of nReps and SPLs that are in the current data set (instance).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_CF_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.get_CF_map"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">get_dataType</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.get_dataType"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">get_data_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.get_data_dir"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">get_data_read</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.get_data_read"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">make_fig</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.make_fig"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">plot_RI_vs_F</code><span class="sig-paren">(</span><em>freq=10000.0</em>, <em>spontclass='HS'</em>, <em>display=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.plot_RI_vs_F"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">plot_Rate_vs_F</code><span class="sig-paren">(</span><em>freq=10000.0</em>, <em>spontclass='HS'</em>, <em>display=False</em>, <em>SPL=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.plot_Rate_vs_F"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>assumes we have done a “read all”</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>freq</strong> – </li>
<li><strong>spontclass</strong> – </li>
<li><strong>display</strong> – </li>
<li><strong>SPL</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">read_AN_data</code><span class="sig-paren">(</span><em>freq=10000</em>, <em>CF=5300</em>, <em>spontclass='HS'</em>, <em>display=False</em>, <em>stim='BFTone'</em>, <em>setflag=True</em>, <em>ignoreflag=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.read_AN_data"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>read responses of auditory nerve model of Zilany et al. (2009).
display = True plots the psth’s for all ANF channels in the dataset
Request response to stimulus at Freq, for fiber with CF
and specified spont rate
This version is for rate-intensity runs March 2014.
Returns: Nothing</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">read_all_ANdata</code><span class="sig-paren">(</span><em>freq=10000.0</em>, <em>CFList=None</em>, <em>spontclass='HS'</em>, <em>stim='BFTone'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.read_all_ANdata"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Reads a bank of AN data, across frequency and intensity, for a given stimulus frequency
Assumptions: the bank of data is consistent in terms of nReps and SPLs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>freq</strong> – Tone stimulus frequency (if stim is Tone or BFTone)</li>
<li><strong>CFList</strong> – A list of the CFs to read</li>
<li><strong>spontclass</strong> – ‘HS’, ‘MS’, or ‘LS’, corresponding to spont rate groups</li>
<li><strong>stim</strong> – Stimulus type - Tone/BFTone, or Noise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Nothing. The data are stored in an array accessible directly or through a selector function</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">read_cmrr_data</code><span class="sig-paren">(</span><em>P</em>, <em>signal='S0'</em>, <em>display=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.read_cmrr_data"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>read responses of auditory nerve model of Zilany et al. (2009).
The required parameters are passed via the class P.
This includes:</p>
<blockquote>
<div>the SN (s2m) is the signal-to-masker ratio to select
the mode is ‘CMR’, ‘CMD’ (deviant) or ‘REF’ (reference, no flanking bands),
‘Tone’, or ‘Noise’
the Spont rate group</div></blockquote>
<p>signal is either ‘S0’ (signal present) or ‘NS’ (no signal)
display = True plots the psth’s for all ANF channels in the dataset
Returns:
tuple of (spikelist and frequency list for modulated tones)</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">retrieve_from_all_AN</code><span class="sig-paren">(</span><em>cf</em>, <em>SPL</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.retrieve_from_all_AN"><span class="viewcode-link">[source]</span></a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cf</strong> – </li>
<li><strong>SPL</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">spike list (all nreps) at the cf and SPL requested, for the loaded stimulus set</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_CF_map</code><span class="sig-paren">(</span><em>low</em>, <em>high</em>, <em>nfreq</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.set_CF_map"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">set_dataType</code><span class="sig-paren">(</span><em>datatype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.set_dataType"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">set_data_dir</code><span class="sig-paren">(</span><em>directory</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/get_anspikes.html#ManageANSpikes.set_data_dir"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="cnmodel-util-matlab-proc">
<h2>cnmodel.util.matlab_proc<a class="headerlink" href="#cnmodel-util-matlab-proc" title="Permalink to this headline">¶</a></h2>
<p>Simple system for interfacing with a MATLAB process using stdin/stdout pipes.</p>
<dl class="exception">
<dt>
<em class="property">exception </em><code class="descclassname">cnmodel.util.matlab_proc.</code><code class="descname">MatlabError</code><span class="sig-paren">(</span><em>error</em>, <em>output</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/matlab_proc.html#MatlabError"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.matlab_proc.</code><code class="descname">MatlabFunction</code><span class="sig-paren">(</span><em>proc</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/matlab_proc.html#MatlabFunction"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Proxy to a MATLAB function.</p>
<p>Calling this object transfers the arguments to MATLAB, invokes the function
remotely, and then transfers the return value back to Python.</p>
<dl class="attribute">
<dt>
<code class="descname">nargout</code></dt>
<dd><p>Number of output arguments for this function.</p>
<p>For some functions, requesting nargout() will fail. In these cases,
the nargout property must be set manually before calling the function.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.matlab_proc.</code><code class="descname">MatlabProcess</code><span class="sig-paren">(</span><em>executable=None</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/matlab_proc.html#MatlabProcess"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class starts a new matlab process, allowing remote control of
the interpreter and transfer of data between python and matlab.</p>
<dl class="method">
<dt>
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/matlab_proc.html#MatlabProcess.close"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">exist</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/matlab_proc.html#MatlabProcess.exist"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.matlab_proc.</code><code class="descname">MatlabReference</code><span class="sig-paren">(</span><em>proc</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/matlab_proc.html#MatlabReference"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reference to a variable in the matlab workspace.</p>
<dl class="method">
<dt>
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/matlab_proc.html#MatlabReference.clear"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">get</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/matlab_proc.html#MatlabReference.get"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">name</code></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="cnmodel-util-nrnutils">
<h2>cnmodel.util.nrnutils<a class="headerlink" href="#cnmodel-util-nrnutils" title="Permalink to this headline">¶</a></h2>
<p>Wrapper classes to make working with NEURON easier.</p>
<p>Author: Andrew P. Davison, UNIC, CNRS</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.nrnutils.</code><code class="descname">Mechanism</code><span class="sig-paren">(</span><em>name</em>, <em>**parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/nrnutils.html#Mechanism"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Examples:
&gt;&gt;&gt; leak = Mechanism(‘pas’, {‘e’: -65, ‘g’: 0.0002})
&gt;&gt;&gt; hh = Mechanism(‘hh’)
added set_parameters to allow post-instantiation parameter modification</p>
<dl class="method">
<dt>
<code class="descname">insert_into</code><span class="sig-paren">(</span><em>section</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/nrnutils.html#Mechanism.insert_into"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">set_parameters</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/nrnutils.html#Mechanism.set_parameters"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.nrnutils.</code><code class="descname">Section</code><span class="sig-paren">(</span><em>L</em>, <em>diam</em>, <em>nseg=1</em>, <em>Ra=100</em>, <em>cm=1</em>, <em>mechanisms=[]</em>, <em>parent=None</em>, <em>connection_point=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/nrnutils.html#Section"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nrn.Section</span></code></p>
<p>Examples:
&gt;&gt;&gt; soma = Section(L=30, diam=30, mechanisms=[hh, leak])
&gt;&gt;&gt; apical = Section(L=600, diam=2, nseg=5, mechanisms=[leak],
…                  parent=soma, connection_point=DISTAL)</p>
<dl class="method">
<dt>
<code class="descname">add_synapse</code><span class="sig-paren">(</span><em>label, type, locations=[0.5], **parameters</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">add_synapses</code><span class="sig-paren">(</span><em>label, type, locations=[0.5], **parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/nrnutils.html#Section.add_synapses"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">plot</code><span class="sig-paren">(</span><em>variable</em>, <em>location=0.5</em>, <em>tmin=0</em>, <em>tmax=5</em>, <em>xmin=-80</em>, <em>xmax=40</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/nrnutils.html#Section.plot"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">record_spikes</code><span class="sig-paren">(</span><em>threshold=-30</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/nrnutils.html#Section.record_spikes"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.nrnutils.</code><code class="descname">alias</code><span class="sig-paren">(</span><em>attribute_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/nrnutils.html#alias"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns a new property, mapping an attribute nested in an object hierarchy
to a simpler name</p>
<p>For example, suppose that an object of class A has an attribute b which
itself has an attribute c which itself has an attribute d. Then placing
e = alias(‘b.c.d’)
in the class definition of A makes A.e an alias for A.b.c.d</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.nrnutils.</code><code class="descname">uniform_property</code><span class="sig-paren">(</span><em>section_list</em>, <em>attribute_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/nrnutils.html#uniform_property"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Define a property that will have a uniform value across a list of sections.</p>
<p>For example, suppose we define a neuron model as a class A, which contains
three compartments: soma, dendrite and axon. Then placing</p>
<blockquote>
<div>gnabar = uniform_property([“soma”, “axon”], “hh.gnabar”)</div></blockquote>
<p>in the class definition of A means that setting a.gnabar (where a is an
instance of A) will set the value of hh.gnabar in both the soma and axon, i.e.</p>
<blockquote>
<div>a.gnabar = 0.01</div></blockquote>
<p>is equivalent to:</p>
<blockquote>
<div><dl class="docutils">
<dt>for sec in [a.soma, a.axon]:</dt>
<dd><dl class="first last docutils">
<dt>for seg in sec:</dt>
<dd>seg.hh.gnabar = 0.01</dd>
</dl>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="cnmodel-util-process">
<h2>cnmodel.util.process<a class="headerlink" href="#cnmodel-util-process" title="Permalink to this headline">¶</a></h2>
<p>Utility class for spawning and controlling CLI processes.
See: <a class="reference external" href="http://stackoverflow.com/questions/375427/non-blocking-read-on-a-subprocess-pipe-in-python">http://stackoverflow.com/questions/375427/non-blocking-read-on-a-subprocess-pipe-in-python</a></p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.process.</code><code class="descname">PipePrinter</code><span class="sig-paren">(</span><em>pipe</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/process.html#PipePrinter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>For debugging writes to a pipe.</p>
<dl class="method">
<dt>
<code class="descname">write</code><span class="sig-paren">(</span><em>strn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/process.html#PipePrinter.write"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.process.</code><code class="descname">PipeQueue</code><span class="sig-paren">(</span><em>pipe</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/process.html#PipeQueue"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Queue.Queue</span></code></p>
<p>Queue that starts a second process to monitor a PIPE for new data.
This is needed to allow non-blocking pipe reads.</p>
<dl class="staticmethod">
<dt>
<em class="property">static </em><code class="descname">enqueue_output</code><span class="sig-paren">(</span><em>queue</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/process.html#PipeQueue.enqueue_output"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">read</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/process.html#PipeQueue.read"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Read all available lines from the queue, concatenated into a single string.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">readline</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/process.html#PipeQueue.readline"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Read a single line from the queue.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.process.</code><code class="descname">Process</code><span class="sig-paren">(</span><em>exec_args</em>, <em>cwd=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/process.html#Process"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Process encapsulates a subprocess with queued stderr/stdout pipes.
Wraps most methods from subprocess.Popen.</p>
<p>For non-blocking reads, use proc.stdout.get_nowait() or
proc.stdout.get(timeout=0.1).</p>
</dd></dl>

</div>
<div class="section" id="cnmodel-util-pynrnutilities">
<h2>cnmodel.util.pynrnutilities<a class="headerlink" href="#cnmodel-util-pynrnutilities" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">all_mechanism_types</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#all_mechanism_types"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a dictionary of all available mechanism types.</p>
<p>Each dictionary key is the name of a mechanism and each value is
another dictionary containing information about the mechanism:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mechanism_types</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;mech_name1&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;point_process&#39;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="s1">&#39;artificial_cell&#39;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="s1">&#39;netcon_target&#39;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="s1">&#39;has_netevent&#39;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="s1">&#39;internal_type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;globals&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="n">size</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span>
        <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="n">size</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span>
        <span class="s1">&#39;assigned&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="n">size</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span>
        <span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="n">size</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span>
    <span class="p">},</span>
    <span class="s1">&#39;mech_name2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span>
    <span class="s1">&#39;mech_name3&#39;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><dl class="first docutils">
<dt>point_process: False for distributed mechanisms, True for point</dt>
<dd>processes and artificial cells.</dd>
</dl>
</li>
<li>artificial_cell: True for artificial cells, False otherwise</li>
<li>netcon_target: True if the mechanism can receive NetCon events</li>
<li>has_netevent: True if the mechanism can emit NetCon events</li>
<li><dl class="first docutils">
<dt>internal_type: Integer specifying the NEURON internal type index of</dt>
<dd>the mechanism</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>globals: dict of the name and vector size of the mechanism’s global</dt>
<dd>variables</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>parameters: dict of the name and vector size of the mechanism’s</dt>
<dd>parameter variables</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>assigned: dict of the name and vector size of the mechanism’s</dt>
<dd>assigned variables</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>state: dict of the name and vector size of the mechanism’s state</dt>
<dd>variables</dd>
</dl>
</li>
</ul>
<p>Note: The returned data structure is cached; do not modify it.</p>
<p>For more information on global, parameter, assigned, and state
variables see:
<a class="reference external" href="http://www.neuron.yale.edu/neuron/static/docs/help/neuron/nmodl/nmodl.html">http://www.neuron.yale.edu/neuron/static/docs/help/neuron/nmodl/nmodl.html</a></p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">all_objects</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#all_objects"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a dict of all objects known to NEURON.</p>
<p>Keys are ‘Section’, ‘Segment’, ‘Mechanism’, ‘Vector’, ‘PointProcess’,
‘NetCon’, …</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">alpha</code><span class="sig-paren">(</span><em>alpha=0.1</em>, <em>delay=1</em>, <em>amp=1.0</em>, <em>tdur=50.0</em>, <em>dt=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#alpha"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">an_syn</code><span class="sig-paren">(</span><em>alpha=0.1</em>, <em>spont=10</em>, <em>driven=100</em>, <em>delay=50</em>, <em>dur=100</em>, <em>post=20</em>, <em>amp=0.1</em>, <em>dt=0.02</em>, <em>N=1</em>, <em>makewave=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#an_syn"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">custom_init</code><span class="sig-paren">(</span><em>v_init=-60.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#custom_init"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Perform a custom initialization of the current model/section.</p>
<p>This initialization follows the scheme outlined in the
NEURON book, 8.4.2, p 197 for initializing to steady state.</p>
<p>N.B.: For a complex model with dendrites/axons and different channels,
this initialization will not find the steady-state the whole cell,
leading to initial transient currents. In that case, this initialization
should be followed with a 0.1-5 second run (depends on the rates in the
various channel mechanisms) with no current injection or active point
processes to allow the system to settle to a steady- state. Use either
h.svstate or h.batch_save to save states and restore them. Batch is
preferred</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v_init</strong> (<em>float</em><em> (</em><em>default: -60 mV</em><em>)</em>) – Voltage to start the initialization process. This should
be close to the expected resting state.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">findspikes</code><span class="sig-paren">(</span><em>t</em>, <em>v</em>, <em>thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#findspikes"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>findspikes identifies the times of action potential in the trace v, with the
times in t. An action potential is simply timed at the first point that exceeds
the threshold.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">get_sections</code><span class="sig-paren">(</span><em>h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#get_sections"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>go through all the sections and find the names of the sections and all of their
parts (ids). Returns a dict, of sec: [id0, id1…]</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">isi_cv</code><span class="sig-paren">(</span><em>splist</em>, <em>binwidth=1</em>, <em>t0=0</em>, <em>t1=300</em>, <em>tgrace=25</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#isi_cv"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>compute the cv and regularity according to Young et al., J. Neurophys, 60: 1, 1988.
Analysis is limited to isi’s starting at or after t0 but before t1, and ending completely
before t1 + tgrace(to avoid end effects). t1 should correspond to the
the end of the stimulus
Version using a list of numpy arrays for cvisi</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">isi_cv2</code><span class="sig-paren">(</span><em>splist</em>, <em>binwidth=1</em>, <em>t0=0</em>, <em>t1=300</em>, <em>tgrace=25</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#isi_cv2"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>compute the cv and regularity according to Young et al., J. Neurophys, 60: 1, 1988.
Analysis is limited to isi’s starting at or after t0 but before t1, and ending completely
before t1 + tgrace(to avoid end effects). t1 should correspond to the
the end of the stimulus
VERSION using dictionary for cvisi</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">mask</code><span class="sig-paren">(</span><em>x</em>, <em>xm</em>, <em>x0</em>, <em>x1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#mask"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">measure</code><span class="sig-paren">(</span><em>mode</em>, <em>x</em>, <em>y</em>, <em>x0</em>, <em>x1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#measure"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>return the mean and standard deviation of y in the window x0 to x1</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">mho2ns</code><span class="sig-paren">(</span><em>mho</em>, <em>somaarea</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#mho2ns"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">nstomho</code><span class="sig-paren">(</span><em>ns</em>, <em>somaarea</em>, <em>refarea=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#nstomho"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">reset</code><span class="sig-paren">(</span><em>raiseError=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#reset"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Introspect the NEURON kernel to verify that no objects are left over
from previous simulation runs.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">spherearea</code><span class="sig-paren">(</span><em>dia</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#spherearea"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>given diameter in microns, return sphere area in cm2</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">syns</code><span class="sig-paren">(</span><em>alpha=0.1</em>, <em>rate=10</em>, <em>delay=0</em>, <em>dur=50</em>, <em>amp=1.0</em>, <em>dt=0.02</em>, <em>N=1</em>, <em>mindur=120</em>, <em>makewave=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#syns"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Calculate a poisson train of alpha waves
with mean rate rate, with a delay and duration (in mseco) dt in msec.
N specifies the number of such independent waveforms to sum</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.pynrnutilities.</code><code class="descname">vector_strength</code><span class="sig-paren">(</span><em>spikes</em>, <em>freq</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/pynrnutilities.html#vector_strength"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Calculate vector strength and related parameters from a spike train, for the specified frequency
:param spikes: Spike train, in msec.
:param freq: Stimulus frequency in Hz
:return: a dictionary containing:</p>
<blockquote>
<div>r: vector strength
n: number of spikes
R: Rayleigh coefficient
p: p value (is distribution not flat?)
ph: the circularized spike train over period of the stimulus freq, freq, in radians
d: the “dispersion” computed according to Ashida et al., 2010, etc.</div></blockquote>
</dd></dl>

</div>
<div class="section" id="cnmodel-util-random-seed">
<h2>cnmodel.util.random_seed<a class="headerlink" href="#cnmodel-util-random-seed" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.random_seed.</code><code class="descname">current_seed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/random_seed.html#current_seed"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return the currently-set global random seed.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.random_seed.</code><code class="descname">set_seed</code><span class="sig-paren">(</span><em>seed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/random_seed.html#set_seed"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Set the random seed to be used globally. If a string is supplied, it
will be converted to int using hash().</p>
<p>This immediately seeds the numpy RNG. Any other RNGs must be seeded using
current_seed()</p>
</dd></dl>

</div>
<div class="section" id="cnmodel-util-sound">
<h2>cnmodel.util.sound<a class="headerlink" href="#cnmodel-util-sound" title="Permalink to this headline">¶</a></h2>
<p>Tools for generating auditory stimuli.</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.sound.</code><code class="descname">ClickTrain</code><span class="sig-paren">(</span><em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#ClickTrain"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">cnmodel.util.sound.Sound</span></code></p>
<p>One or more clicks (rectangular pulses).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rate</strong> (<em>float</em>) – Sample rate in Hz</li>
<li><strong>dbspl</strong> (<em>float</em>) – Maximum amplitude of click in dB SPL.</li>
<li><strong>click_duration</strong> (<em>float</em>) – Duration of each click including ramp time. Must be at least
1/rate.</li>
<li><strong>click_starts</strong> (<em>array-like</em>) – Start times of each click</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt>
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#ClickTrain.generate"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate and return the sound output. This method is defined by subclasses.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.sound.</code><code class="descname">FMSweep</code><span class="sig-paren">(</span><em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#FMSweep"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">cnmodel.util.sound.Sound</span></code></p>
<p>Create an FM sweep with either linear or logarithmic rates,
of a specified duration between two frequencies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rate</strong> (<em>float</em>) – Sample rate in Hz</li>
<li><strong>duration</strong> (<em>float</em>) – Total duration of the sweep</li>
<li><strong>start</strong> (<em>float</em>) – t times of each pip</li>
<li><strong>freqs</strong> (<em>list</em>) – [f0, f1]: the start and stop times for the sweep</li>
<li><strong>ramp</strong> (<em>string</em>) – valid input for type of sweep (linear, logarithmic, etc)</li>
<li><strong>dbspl</strong> (<em>float</em>) – Maximum amplitude of pip in dB SPL.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt>
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#FMSweep.generate"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Call to actually compute the the FM sweep</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">generated waveform</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.sound.</code><code class="descname">NoisePip</code><span class="sig-paren">(</span><em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#NoisePip"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">cnmodel.util.sound.Sound</span></code></p>
<p>One or more noise pips with cosine-ramped edges.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rate</strong> (<em>float</em>) – Sample rate in Hz</li>
<li><strong>duration</strong> (<em>float</em>) – Total duration of the sound</li>
<li><strong>seed</strong> (<em>int &gt;= 0</em>) – Random seed</li>
<li><strong>dbspl</strong> (<em>float</em>) – Maximum amplitude of tone in dB SPL.</li>
<li><strong>pip_duration</strong> (<em>float</em>) – Duration of each pip including ramp time. Must be at least
2 * ramp_duration.</li>
<li><strong>pip_start</strong> (<em>array-like</em>) – Start times of each pip</li>
<li><strong>ramp_duration</strong> (<em>float</em>) – Duration of a single ramp period (from minimum to maximum).
This may not be more than half of pip_duration.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt>
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#NoisePip.generate"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Call to compute the noise pips</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">generated waveform</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.sound.</code><code class="descname">SAMNoise</code><span class="sig-paren">(</span><em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#SAMNoise"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">cnmodel.util.sound.Sound</span></code></p>
<p>One or more gaussian noise pips with cosine-ramped edges, sinusoidally modulated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rate</strong> (<em>float</em>) – Sample rate in Hz</li>
<li><strong>duration</strong> (<em>float</em>) – Total duration of the sound</li>
<li><strong>seed</strong> (<em>int &gt;= 0</em>) – Random seed</li>
<li><strong>dbspl</strong> (<em>float</em>) – Maximum amplitude of pip in dB SPL.</li>
<li><strong>pip_duration</strong> (<em>float</em>) – Duration of each pip including ramp time. Must be at least
2 * ramp_duration.</li>
<li><strong>pip_start</strong> (<em>array-like</em>) – Start times of each pip</li>
<li><strong>ramp_duration</strong> (<em>float</em>) – Duration of a single ramp period (from minimum to maximum).
This may not be more than half of pip_duration.</li>
<li><strong>fmod</strong> (<em>float</em>) – SAM modulation frequency</li>
<li><strong>dmod</strong> (<em>float</em>) – Modulation depth</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">waveform</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt>
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#SAMNoise.generate"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate and return the sound output. This method is defined by subclasses.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.sound.</code><code class="descname">SAMTone</code><span class="sig-paren">(</span><em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#SAMTone"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">cnmodel.util.sound.Sound</span></code></p>
<p>SAM tones with cosine-ramped edges.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rate</strong> (<em>float</em>) – Sample rate in Hz</li>
<li><strong>duration</strong> (<em>float</em>) – Total duration of the sound</li>
<li><strong>f0</strong> (<em>float</em><em> or </em><em>array-like</em>) – Tone frequency in Hz. Must be less than half of the sample rate.</li>
<li><strong>dbspl</strong> (<em>float</em>) – Maximum amplitude of tone in dB SPL.</li>
<li><strong>pip_duration</strong> (<em>float</em>) – Duration of each pip including ramp time. Must be at least
2 * ramp_duration.</li>
<li><strong>pip_start</strong> (<em>array-like</em>) – Start times of each pip</li>
<li><strong>ramp_duration</strong> (<em>float</em>) – Duration of a single ramp period (from minimum to maximum).
This may not be more than half of pip_duration.</li>
<li><strong>fmod</strong> (<em>float</em>) – SAM modulation frequency, Hz</li>
<li><strong>dmod</strong> (<em>float</em>) – Modulation depth, %</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt>
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#SAMTone.generate"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Call to compute a SAM tone</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">generated waveform</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.sound.</code><code class="descname">Sound</code><span class="sig-paren">(</span><em>duration</em>, <em>rate=100000.0</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#Sound"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for all sound stimulus generators.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>duration</strong> (<em>float</em><em> (</em><em>no default</em><em>)</em><em>:</em>) – duration of the stimulus, in seconds</li>
<li><strong>rate</strong> (<em>float</em><em> (</em><em>default: 100000.</em><em>)</em>) – sample rate for sound generation</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt>
<code class="descname">dt</code></dt>
<dd><p><em>float</em> – the sample period (time step between samples).</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">duration</code></dt>
<dd><p><em>float</em> – The duration of the sound</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#Sound.generate"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate and return the sound output. This method is defined by subclasses.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">key</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#Sound.key"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>The sound can be recreated using <code class="docutils literal notranslate"><span class="pre">create(**key)</span></code>.
<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>: Return dict of parameters needed to completely describe this sound.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">measure_dbspl</code><span class="sig-paren">(</span><em>tstart</em>, <em>tend</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#Sound.measure_dbspl"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Measure the sound pressure for the waveform in a window of time</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tstart</strong> – time to start spl measurement (seconds).</li>
<li><strong>tend</strong> – ending time for spl measurement (seconds).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>float</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">The measured amplitude (dBSPL) of the sound from tstart to tend</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">num_samples</code></dt>
<dd><p><em>int</em> – The number of samples in the sound array.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">sound</code></dt>
<dd><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code> – The generated sound array, expressed in Pascals.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">time</code></dt>
<dd><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code> – The array of time values, expressed in seconds.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.sound.</code><code class="descname">TonePip</code><span class="sig-paren">(</span><em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#TonePip"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">cnmodel.util.sound.Sound</span></code></p>
<p>Create one or more tone pips with cosine-ramped edges.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rate</strong> (<em>float</em>) – Sample rate in Hz</li>
<li><strong>duration</strong> (<em>float</em>) – Total duration of the sound</li>
<li><strong>f0</strong> (<em>float</em><em> or </em><em>array-like</em>) – Tone frequency in Hz. Must be less than half of the sample rate.</li>
<li><strong>dbspl</strong> (<em>float</em>) – Maximum amplitude of tone in dB SPL.</li>
<li><strong>pip_duration</strong> (<em>float</em>) – Duration of each pip including ramp time. Must be at least
2 * ramp_duration.</li>
<li><strong>pip_start</strong> (<em>array-like</em>) – Start times of each pip</li>
<li><strong>ramp_duration</strong> (<em>float</em>) – Duration of a single ramp period (from minimum to maximum).
This may not be more than half of pip_duration.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt>
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#TonePip.generate"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Call to compute the tone pips</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">generated waveform</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.sound.</code><code class="descname">clicks</code><span class="sig-paren">(</span><em>t</em>, <em>Fs</em>, <em>dBSPL</em>, <em>click_duration</em>, <em>click_starts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#clicks"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create a waveform with multiple retangular clicks. Output is in
Pascals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>array</em>) – array of time values</li>
<li><strong>Fs</strong> (<em>float</em>) – sample frequency (Hz)</li>
<li><strong>click_start</strong> (<em>float</em><em> (</em><em>seconds</em><em>)</em>) – delay to first click in train</li>
<li><strong>click_duration</strong> (<em>float</em><em> (</em><em>seconds</em><em>)</em>) – duration of each click</li>
<li><strong>click_interval</strong> (<em>float</em><em> (</em><em>seconds</em><em>)</em>) – interval between click starts</li>
<li><strong>nclicks</strong> (<em>int</em>) – number of clicks in the click train</li>
<li><strong>dspl</strong> (<em>float</em>) – maximum sound pressure level of pip</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">waveform</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.sound.</code><code class="descname">create</code><span class="sig-paren">(</span><em>type</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#create"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create a Sound instance using a key returned by Sound.key().</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.sound.</code><code class="descname">dbspl_to_pa</code><span class="sig-paren">(</span><em>dbspl</em>, <em>ref=2e-05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#dbspl_to_pa"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert dBSPL to Pascals (rms). By default, the reference pressure is
20 uPa.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.sound.</code><code class="descname">fmsweep</code><span class="sig-paren">(</span><em>t</em>, <em>start</em>, <em>duration</em>, <em>freqs</em>, <em>ramp</em>, <em>dBSPL</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#fmsweep"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create a waveform for an FM sweep over time. Output is in
Pascals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>array</em>) – time array for waveform</li>
<li><strong>start</strong> (<em>float</em><em> (</em><em>seconds</em><em>)</em>) – start time for sweep</li>
<li><strong>duration</strong> (<em>float</em><em> (</em><em>seconds</em><em>)</em>) – duration of sweep</li>
<li><strong>freqs</strong> (<em>array</em><em> (</em><em>Hz</em><em>)</em>) – Two-element array specifying the start and end frequency of the sweep</li>
<li><strong>ramp</strong> (<em>str</em>) – The shape of time course of the sweep (linear, logarithmic)</li>
<li><strong>dBSPL</strong> (<em>float</em>) – maximum sound pressure level of sweep</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">waveform</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.sound.</code><code class="descname">linearramp</code><span class="sig-paren">(</span><em>pin</em>, <em>mxpts</em>, <em>irpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#linearramp"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Apply linear ramps to <em>pin</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pin</strong> (<em>array</em>) – input waveform to apply ramp to</li>
<li><strong>mxpts</strong> (<em>int</em>) – point in array to start ramp down</li>
<li><strong>irpts</strong> (<em>int</em>) – duration of the ramp</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">waveform</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
<p>Original (adapted from Manis; makeANF_CF_RI.m):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="p">[</span><span class="n">out</span><span class="p">]</span> <span class="o">=</span> <span class="n">ramp</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span> <span class="n">mxpts</span><span class="p">,</span> <span class="n">irpts</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">pin</span><span class="p">;</span>
    <span class="n">out</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">irpts</span><span class="p">)</span><span class="o">=</span><span class="n">pin</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">irpts</span><span class="p">)</span><span class="o">.*</span><span class="p">(</span><span class="mi">0</span><span class="p">:(</span><span class="n">irpts</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">irpts</span><span class="p">;</span>
    <span class="n">out</span><span class="p">((</span><span class="n">mxpts</span><span class="o">-</span><span class="n">irpts</span><span class="p">):</span><span class="n">mxpts</span><span class="p">)</span><span class="o">=</span><span class="n">pin</span><span class="p">((</span><span class="n">mxpts</span><span class="o">-</span><span class="n">irpts</span><span class="p">):</span><span class="n">mxpts</span><span class="p">)</span><span class="o">.*</span><span class="p">(</span><span class="n">irpts</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">irpts</span><span class="p">;</span>
    <span class="k">return</span><span class="p">;</span>
<span class="n">end</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.sound.</code><code class="descname">modnoise</code><span class="sig-paren">(</span><em>t</em>, <em>rt</em>, <em>Fs</em>, <em>F0</em>, <em>dur</em>, <em>start</em>, <em>dBSPL</em>, <em>FMod</em>, <em>DMod</em>, <em>phaseshift</em>, <em>seed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#modnoise"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate an amplitude-modulated noise with linear ramps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>array</em>) – array of waveform time values</li>
<li><strong>rt</strong> (<em>float</em>) – ramp duration</li>
<li><strong>Fs</strong> (<em>float</em>) – sample rate</li>
<li><strong>F0</strong> (<em>float</em>) – tone frequency</li>
<li><strong>dur</strong> (<em>float</em>) – duration of noise</li>
<li><strong>start</strong> (<em>float</em>) – start time for noise</li>
<li><strong>dBSPL</strong> (<em>float</em>) – sound pressure of stimulus</li>
<li><strong>FMod</strong> (<em>float</em>) – modulation frequency</li>
<li><strong>DMod</strong> (<em>float</em>) – modulation depth percent</li>
<li><strong>phaseshift</strong> (<em>float</em>) – modulation phase</li>
<li><strong>seed</strong> (<em>int</em>) – seed for random number generator</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">waveform</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.sound.</code><code class="descname">pa_to_dbspl</code><span class="sig-paren">(</span><em>pa</em>, <em>ref=2e-05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#pa_to_dbspl"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert Pascals (rms) to dBSPL. By default, the reference pressure is
20 uPa.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.sound.</code><code class="descname">pipnoise</code><span class="sig-paren">(</span><em>t</em>, <em>rt</em>, <em>Fs</em>, <em>dBSPL</em>, <em>pip_dur</em>, <em>pip_start</em>, <em>seed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#pipnoise"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create a waveform with multiple sine-ramped noise pips. Output is in
Pascals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>array</em>) – array of time values</li>
<li><strong>rt</strong> (<em>float</em>) – ramp duration</li>
<li><strong>Fs</strong> (<em>float</em>) – sample rate</li>
<li><strong>dBSPL</strong> (<em>float</em>) – maximum sound pressure level of pip</li>
<li><strong>pip_dur</strong> (<em>float</em>) – duration of pip including ramps</li>
<li><strong>pip_start</strong> (<em>float</em>) – list of starting times for multiple pips</li>
<li><strong>seed</strong> (<em>int</em>) – random seed</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">waveform</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.sound.</code><code class="descname">piptone</code><span class="sig-paren">(</span><em>t</em>, <em>rt</em>, <em>Fs</em>, <em>F0</em>, <em>dBSPL</em>, <em>pip_dur</em>, <em>pip_start</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#piptone"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create a waveform with multiple sine-ramped tone pips. Output is in
Pascals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>array</em>) – array of time values</li>
<li><strong>rt</strong> (<em>float</em>) – ramp duration</li>
<li><strong>Fs</strong> (<em>float</em>) – sample rate</li>
<li><strong>F0</strong> (<em>float</em>) – pip frequency</li>
<li><strong>dBSPL</strong> (<em>float</em>) – maximum sound pressure level of pip</li>
<li><strong>pip_dur</strong> (<em>float</em>) – duration of pip including ramps</li>
<li><strong>pip_start</strong> (<em>float</em>) – list of starting times for multiple pips</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">waveform</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.sound.</code><code class="descname">sinusoidal_modulation</code><span class="sig-paren">(</span><em>t</em>, <em>basestim</em>, <em>tstart</em>, <em>fmod</em>, <em>dmod</em>, <em>phaseshift</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/sound.html#sinusoidal_modulation"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate a sinusoidally amplitude-modulation of the input stimulus.
For dmod=100%, the envelope max is 2, the min is 0; for dmod = 0, the max and min are 1
maintains equal energy for all modulation depths.
Equation from Rhode and Greenberg, J. Neurophys, 1994 (adding missing parenthesis) and
Sayles et al. J. Physiol. 2013
The envelope can be phase shifted (useful for co-deviant stimuli).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t</strong> (<em>array</em>) – array of waveform time values (seconds)</li>
<li><strong>basestim</strong> (<em>array</em>) – array of waveform values that will be subject to sinulsoidal envelope modulation</li>
<li><strong>tstart</strong> (<em>float</em>) – time at which the base sound starts (modulation starts then, with 0 phase crossing)
(seconds)</li>
<li><strong>fmod</strong> (<em>float</em>) – modulation frequency (Hz)</li>
<li><strong>dmod</strong> (<em>float</em>) – modulation depth (percent)</li>
<li><strong>phaseshift</strong> (<em>float</em>) – modulation phase shift (starting phase, radians)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="cnmodel-util-stim">
<h2>cnmodel.util.stim<a class="headerlink" href="#cnmodel-util-stim" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt>
<code class="descclassname">cnmodel.util.stim.</code><code class="descname">make_pulse</code><span class="sig-paren">(</span><em>stim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/stim.html#make_pulse"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generate a pulse train for current / voltage command. Returns a tuple.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>stim</strong> (<em>dict</em>) – <p>Holds parameters that determine stimulus shape:</p>
<ul class="simple">
<li>delay : time before first pulse</li>
<li>Sfreq : frequency of pulses</li>
<li>dur : duration of one pulse or main pulse</li>
<li>predur : duration of prepulse (default should be 0 for no prepulse)</li>
<li>amp : pulse amplitude</li>
<li>preamp : amplitude of prepulse</li>
<li>PT : delay between end of train and test pulse (0 for no test)</li>
<li>NP : number of pulses</li>
<li>hold : holding level (optional)</li>
<li>dt : timestep</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>w</strong> (<em>stimulus waveform</em>)</li>
<li><strong>maxt</strong> (<em>duration of waveform</em>)</li>
<li><strong>tstims</strong> (<em>index of each pulse in the train</em>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="cnmodel-util-user-tester">
<h2>cnmodel.util.user_tester<a class="headerlink" href="#cnmodel-util-user-tester" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">cnmodel.util.user_tester.</code><code class="descname">UserTester</code><span class="sig-paren">(</span><em>key</em>, <em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/user_tester.html#UserTester"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for testing when a human is required to verify the results.</p>
<p>When a test is passed by the user, its output is saved and used as a basis
for future tests. If future test results do not match the stored results,
then the user is asked to decide whether to fail the test, or pass the
test and store new results.</p>
<p>Subclasses must reimplement run_test() to return a dictionary of results
to store. Optionally, compare_results and audit_result may also be
reimplemented to customize the testing behavior.</p>
<p>By default, test results are stored in a ‘test_data’ directory relative
to the file that defines the UserTester subclass in use.</p>
<p>Initialize with a string <em>key</em> that provides a short, unique
description of this test. All other arguments are passed to run_test().</p>
<p><em>key</em> is used to determine the file name for storing test results.</p>
<dl class="method">
<dt>
<code class="descname">assert_test_info</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/user_tester.html#UserTester.assert_test_info"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Test <em>cell</em> and raise exception if the results do not match prior
data.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">audit_result</code><span class="sig-paren">(</span><em>info</em>, <em>expect</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/user_tester.html#UserTester.audit_result"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Display results and ask the user to decide whether the test passed.
Return True for pass, False for fail.</p>
<p>If <em>expect</em> is None, then no previous test results were stored.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">compare_results</code><span class="sig-paren">(</span><em>info</em>, <em>expect</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/user_tester.html#UserTester.compare_results"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compare <em>result</em> of the current test against the previously stored
result <em>expect</em>. If <em>expect</em> is None, then no previous result was
stored.</p>
<p>If <em>result</em> and <em>expect</em> do not match, then raise an exception.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">data_dir</code><em class="property"> = 'test_data'</em></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">load_test_result</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/user_tester.html#UserTester.load_test_result"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Load prior test results for <em>self.key</em>.
If there are no prior results, return None.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">result_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/user_tester.html#UserTester.result_file"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return a file name to be used for storing / retrieving test results
given <em>self.key</em>.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">run_test</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/user_tester.html#UserTester.run_test"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Exceute the test. All arguments are taken from __init__.
Return a picklable dictionary of test results.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">save_test_result</code><span class="sig-paren">(</span><em>result</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cnmodel/util/user_tester.html#UserTester.save_test_result"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Store test results for <em>self.key</em>.
Th e*result* argument must be picklable.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">cnmodel.util package</a><ul>
<li><a class="reference internal" href="#cnmodel-util-params">cnmodel.util.Params</a></li>
<li><a class="reference internal" href="#cnmodel-util-ccstim">cnmodel.util.ccstim</a></li>
<li><a class="reference internal" href="#cnmodel-util-expfitting">cnmodel.util.expfitting</a></li>
<li><a class="reference internal" href="#cnmodel-util-filelock">cnmodel.util.filelock</a></li>
<li><a class="reference internal" href="#cnmodel-util-find-point">cnmodel.util.find_point</a></li>
<li><a class="reference internal" href="#cnmodel-util-fitting">cnmodel.util.fitting</a></li>
<li><a class="reference internal" href="#cnmodel-util-get-anspikes">cnmodel.util.get_anspikes</a></li>
<li><a class="reference internal" href="#cnmodel-util-matlab-proc">cnmodel.util.matlab_proc</a></li>
<li><a class="reference internal" href="#cnmodel-util-nrnutils">cnmodel.util.nrnutils</a></li>
<li><a class="reference internal" href="#cnmodel-util-process">cnmodel.util.process</a></li>
<li><a class="reference internal" href="#cnmodel-util-pynrnutilities">cnmodel.util.pynrnutilities</a></li>
<li><a class="reference internal" href="#cnmodel-util-random-seed">cnmodel.util.random_seed</a></li>
<li><a class="reference internal" href="#cnmodel-util-sound">cnmodel.util.sound</a></li>
<li><a class="reference internal" href="#cnmodel-util-stim">cnmodel.util.stim</a></li>
<li><a class="reference internal" href="#cnmodel-util-user-tester">cnmodel.util.user_tester</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="protocols.html"
                        title="previous chapter">cnmodel.protocols package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/util.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="protocols.html" title="cnmodel.protocols package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CNModel 0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >API Reference</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, 2018, Paul B. Manis and Luke Campagnola.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.2.
    </div>
  </body>
</html>