
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>cnmodel.synapses.stochastic_terminal &#8212; CNModel 0.2 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">CNModel 0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for cnmodel.synapses.stochastic_terminal</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">neuron</span> <span class="k">import</span> <span class="n">h</span>

<span class="kn">from</span> <span class="nn">.terminal</span> <span class="k">import</span> <span class="n">Terminal</span>
<span class="kn">from</span> <span class="nn">..util</span> <span class="k">import</span> <span class="n">random_seed</span>

<span class="c1"># utility class to create parameter lists... </span>
<span class="c1"># create like: p = Params(abc=2.0, defg = 3.0, lunch=&#39;sandwich&#39;)</span>
<span class="c1"># reference like p.abc, p.defg, etc.</span>
<div class="viewcode-block" id="Params"><a class="viewcode-back" href="../../../synapses.html#cnmodel.synapses.stochastic_terminal.Params">[docs]</a><span class="k">class</span> <span class="nc">Params</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds</span><span class="p">)</span></div>


<div class="viewcode-block" id="StochasticTerminal"><a class="viewcode-back" href="../../../synapses.html#cnmodel.synapses.stochastic_terminal.StochasticTerminal">[docs]</a><span class="k">class</span> <span class="nc">StochasticTerminal</span><span class="p">(</span><span class="n">Terminal</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Axon terminal with multi-site sctochastic release mechanism.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pre_sec</span><span class="p">,</span> <span class="n">target_cell</span><span class="p">,</span> <span class="n">nzones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">multisite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;lognormal&#39;</span><span class="p">,</span> <span class="n">identifier</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">stochastic_pars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">calcium_pars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spike_source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dep_flag</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This routine creates a (potentially) multisite synapse using a NEURON mod file with:</span>
<span class="sd">            - A MultiSiteSynapse release mechanism that includes stochastic release, with a lognormal</span>
<span class="sd">              release latency distribution. The Facilitation and Depression of release are governed</span>
<span class="sd">              by parameters obtaine from fitting the Dittman-Kreitzer-Regher (DKR) model (J Neurosci. 2000 Feb 15;20(4):1374-85.)</span>
<span class="sd">              to experimental data at various</span>
<span class="sd">              frequencies.</span>
<span class="sd">            - A &quot;cleft&quot; mechanism (models diffusion of transmitter). Note that the cleft is inserted as part of the</span>
<span class="sd">              presynaptic section, but is not connected to the postsynaptic side yet.</span>
<span class="sd">                 </span>
<span class="sd">        Each release site is stochastically independent, but all sites within a terminal are drive by the</span>
<span class="sd">        same presynaptic action potentials.</span>
<span class="sd">        </span>
<span class="sd">        Turning off the depression and facilitation in the kinetic portion of the model substantially decreases</span>
<span class="sd">        the time the terminal mechanism takes to run. </span>
<span class="sd">                 </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pre_sec : :obj:`section`</span>
<span class="sd">             The NEURON section where the synaptic mechanisms should be inserted.</span>
<span class="sd">        target_cell : :obj:`Cell`</span>
<span class="sd">             The target cell object that the synapse will innervate. </span>
<span class="sd">        nzones : int</span>
<span class="sd">              The number of activate zones to insert into the section.</span>
<span class="sd">        multisite : bool, default: True</span>
<span class="sd">            A flag that determines whether the terminal actually creates multiple </span>
<span class="sd">            release zones (True) or just creates a single release zone that</span>
<span class="sd">            varies its amplitude based on the depression/facilitation state.</span>
<span class="sd">        message : str</span>
<span class="sd">              A message to print when instantiating (mostly for verification of code flow).</span>
<span class="sd">        type: str (default: &#39;lognormal&#39;)</span>
<span class="sd">            &#39;lognormal&#39; sets the release event latency distribution to use a lognormal function. Currently,</span>
<span class="sd">            no other function is supported.</span>
<span class="sd">        identifier : int (default: 0)</span>
<span class="sd">             An identifier to associate with these release sites so we can find them later.</span>
<span class="sd">        stochastic_pars : dict (default: None)</span>
<span class="sd">             A dictionary of parameters (Param class) used to specifiy the stochastic behavior of this site,</span>
<span class="sd">             including release latency, stdev, and lognormal distribution paramaters</span>
<span class="sd">        calcium_pars : dict (default: None)</span>
<span class="sd">             A dictionary of parameters (Param class) to determine the calcium channels in this section.</span>
<span class="sd">             If None, then no calcium channels are inserted; otherwise, a P-type calcium conductance and a dynamic</span>
<span class="sd">             mechanism are inserted, and their conductance is set.</span>
<span class="sd">        delay : float (default: 0)</span>
<span class="sd">             Delay time in msec from action potential until transmitter release for this terminal.</span>
<span class="sd">        debug : bool (default: False)</span>
<span class="sd">             Flag to print stuff out while debugging. </span>
<span class="sd">        spike_source : :obj:`section` (default: None)</span>
<span class="sd">             The input spike source to use in net con - default is to use pre_sec when set to None.</span>
<span class="sd">        dep_flag : int (default: 1)</span>
<span class="sd">             Set to 1 for depression mechanism (slows computation), 0 to turn off the depression calculations</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            the list contains the terminal, the relsites, and the list of cleft mechanisms:</span>
<span class="sd">                 </span>
<span class="sd">            - terminal: this is the pointer to the terminal section that was inserted (same as pre_sec if it was</span>
<span class="sd">              specified)</span>
<span class="sd">            - relsite: a list of the nzones release sites that were created</span>
<span class="sd">            - cleft: a list of the nzones cleft mechanisms that were created.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Terminal</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pre_sec</span><span class="p">)</span>
        
        
        <span class="c1"># set parameter control for the stochastic release of vesicles...</span>
        <span class="c1"># this structure is passed to stochastic synapses, and replaces several variables </span>
        <span class="c1"># that were previously defined in the call to that function.</span>
            
        <span class="n">thresh</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span> <span class="c1"># mV - AP detection on the presynaptic side.</span>
        
        <span class="n">ANTerminals_Latency</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># latency </span>
        <span class="n">vPars</span> <span class="o">=</span> <span class="n">Params</span><span class="p">(</span><span class="n">LN_Flag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">LN_t0</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">LN_A0</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">LN_tau</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">LN_std</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                    <span class="n">Lat_Flag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Lat_t0</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">Lat_A0</span><span class="o">=</span><span class="mf">0.140</span><span class="p">,</span> <span class="n">Lat_tau</span><span class="o">=</span><span class="mf">21.5</span><span class="p">,</span>
                    <span class="n">latency</span><span class="o">=</span><span class="n">ANTerminals_Latency</span><span class="p">)</span>
        <span class="c1">#NOTE: stochastic_pars must define parameters used by multisite, including:</span>
            <span class="c1">#.delay is the netcon delay between the presynaptic AP and the start of release events</span>
            <span class="c1">#.Latency is the latency to the mean release event... this could be confusing.</span>
        
        <span class="k">if</span> <span class="n">stochastic_pars</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stochastic_pars</span> <span class="o">=</span> <span class="n">vPars</span>
            
        <span class="n">message</span><span class="o">=</span><span class="s1">&#39;  &gt;&gt; creating terminal with </span><span class="si">%d</span><span class="s1"> release zones using lognormal release latencies (coh4)&#39;</span> <span class="o">%</span> <span class="n">nzones</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span> <span class="n">message</span>
        <span class="n">terminal</span> <span class="o">=</span> <span class="n">pre_sec</span>
        <span class="c1">#terminal.push()</span>
        <span class="k">if</span> <span class="n">calcium_pars</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">terminal</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;cap&#39;</span><span class="p">)</span> <span class="c1"># insert calcium channel density</span>
            <span class="n">terminal</span><span class="p">()</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">pcabar</span> <span class="o">=</span> <span class="n">calcium_pars</span><span class="o">.</span><span class="n">Ca_gbar</span>
            <span class="n">terminal</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;cad&#39;</span><span class="p">)</span>
            
        <span class="c1"># Create point process to simulate multiple independent release zones.</span>
        <span class="n">relsite</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">MultiSiteSynapse</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="n">terminal</span><span class="p">)</span>
        <span class="n">relsite</span><span class="o">.</span><span class="n">nZones</span> <span class="o">=</span> <span class="n">nzones</span>
        <span class="k">if</span> <span class="n">multisite</span><span class="p">:</span>
            <span class="n">relsite</span><span class="o">.</span><span class="n">multisite</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">relsite</span><span class="o">.</span><span class="n">rseed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="o">.</span><span class="n">current_seed</span><span class="p">()</span>  <span class="c1"># use global random seed</span>
            <span class="n">relsite</span><span class="o">.</span><span class="n">latency</span> <span class="o">=</span> <span class="n">stochastic_pars</span><span class="o">.</span><span class="n">latency</span>
            <span class="n">relsite</span><span class="o">.</span><span class="n">latstd</span> <span class="o">=</span> <span class="n">stochastic_pars</span><span class="o">.</span><span class="n">LN_std</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_rzones</span> <span class="o">=</span> <span class="n">nzones</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">relsite</span><span class="o">.</span><span class="n">multisite</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">release_rng</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Random</span><span class="p">(</span><span class="n">random_seed</span><span class="o">.</span><span class="n">current_seed</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">release_rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">relsite</span><span class="o">.</span><span class="n">setUniformRNG</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">release_rng</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_rzones</span> <span class="o">=</span> <span class="mi">1</span>
        
        <span class="n">relsite</span><span class="o">.</span><span class="n">Dep_Flag</span> <span class="o">=</span> <span class="n">dep_flag</span>  <span class="c1"># control synaptic dynamics</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">relsite</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">relsite</span><span class="o">.</span><span class="n">Identifier</span> <span class="o">=</span> <span class="n">identifier</span>
        <span class="c1"># if type == &#39;gamma&#39;:</span>
        <span class="c1">#     gd = gamma.rvs(2, size=10000)/2.0 # get a sample of 10000 events with a gamma dist of 2, set to mean of 1.0</span>
        <span class="c1">#     if relsite.latstd &gt; 0.0:</span>
        <span class="c1">#         gds = relsite.latency+std*(gd-1.0)/gd.std() # scale standard deviation</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         gds = relsite.latency*np.ones((10000,1))</span>
        <span class="c1"># if type == &#39;lognormal&#39;:</span>
        <span class="c1">#     if std &gt; 0.0:</span>
        <span class="c1">#         gds = lognormal(mean=0, sigma=relsite.latstd, size=10000)</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         gds = np.zeros((10000, 1))</span>
        <span class="c1"># use the variable latency mode of COH4. And, it is lognormal no matter what.</span>
        <span class="c1"># the parameters are defined in COH4.mod as follows</span>
        <span class="c1">#    Time course of latency shift in release during repetitive stimulation</span>
        <span class="c1">#   Lat_Flag = 0 (1) : 0 means fixed latency, 1 means lognormal distribution</span>
        <span class="c1">#   Lat_t0 = 0.0 (ms) : minimum time since simulation start before changes in latency are calculated</span>
        <span class="c1">#   Lat_A0 = 0.0 (ms) : size of latency shift from t0 to infinity</span>
        <span class="c1">#   Lat_tau = 100.0 (ms) : rate of change of latency shift (from fit of a+b(1-exp(-t/tau)))</span>
        <span class="c1">#   : Statistical control of log-normal release shape over time during repetive stimulation</span>
        <span class="c1">#   LN_Flag = 0 (1) : 0 means fixed values for all time</span>
        <span class="c1">#   LN_t0 = 0.0 (ms) : : minimum time since simulation start before changes in distribution are calculated</span>
        <span class="c1">#   LN_A0 = 0.0 (ms) : size of change in sigma from t0 to infinity</span>
        <span class="c1">#   LN_tau = 100.0 (ms) : rate of change of sigma over time (from fit of a+b*(1-exp(-t/tau)))</span>

        <span class="n">relsite</span><span class="o">.</span><span class="n">LN_Flag</span> <span class="o">=</span> <span class="n">stochastic_pars</span><span class="o">.</span><span class="n">LN_Flag</span> <span class="c1"># enable use of lognormal release latency</span>
        <span class="n">relsite</span><span class="o">.</span><span class="n">LN_t0</span> <span class="o">=</span> <span class="n">stochastic_pars</span><span class="o">.</span><span class="n">LN_t0</span>
        <span class="n">relsite</span><span class="o">.</span><span class="n">LN_A0</span> <span class="o">=</span> <span class="n">stochastic_pars</span><span class="o">.</span><span class="n">LN_A0</span>
        <span class="n">relsite</span><span class="o">.</span><span class="n">LN_tau</span> <span class="o">=</span> <span class="n">stochastic_pars</span><span class="o">.</span><span class="n">LN_tau</span>
        <span class="n">relsite</span><span class="o">.</span><span class="n">Lat_Flag</span> <span class="o">=</span> <span class="n">stochastic_pars</span><span class="o">.</span><span class="n">Lat_Flag</span>
        <span class="n">relsite</span><span class="o">.</span><span class="n">Lat_t0</span> <span class="o">=</span> <span class="n">stochastic_pars</span><span class="o">.</span><span class="n">Lat_t0</span>
        <span class="n">relsite</span><span class="o">.</span><span class="n">Lat_A0</span> <span class="o">=</span> <span class="n">stochastic_pars</span><span class="o">.</span><span class="n">Lat_A0</span>
        <span class="n">relsite</span><span class="o">.</span><span class="n">Lat_tau</span> <span class="o">=</span> <span class="n">stochastic_pars</span><span class="o">.</span><span class="n">Lat_tau</span>
            <span class="c1">#mpl.figure(2)</span>
            
        <span class="n">h</span><span class="o">.</span><span class="n">pop_section</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span> <span class="o">=</span> <span class="n">relsite</span>

        <span class="k">if</span> <span class="n">spike_source</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">spike_source</span> <span class="o">=</span> <span class="n">pre_sec</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">_ref_v</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">netcon</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">NetCon</span><span class="p">(</span><span class="n">spike_source</span><span class="p">,</span> <span class="n">relsite</span><span class="p">,</span> <span class="n">thresh</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="n">pre_sec</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">netcon</span><span class="o">.</span><span class="n">weight</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">netcon</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="o">-</span><span class="mf">30.0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setPsdType</span><span class="p">(</span><span class="n">target_cell</span><span class="p">,</span> <span class="n">select</span><span class="p">)</span>

<div class="viewcode-block" id="StochasticTerminal.setPsdType"><a class="viewcode-back" href="../../../synapses.html#cnmodel.synapses.stochastic_terminal.StochasticTerminal.setPsdType">[docs]</a>    <span class="k">def</span> <span class="nf">setPsdType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_cell</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assign a postsynpatic density type - selection of receptors to be</span>
<span class="sd">        associated with the presynaptic terminal.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        target_cell : :obj:`NEURON section`</span>
<span class="sd">            Define the target cell so that the correct PSD is inserted</span>
<span class="sd">        </span>
<span class="sd">        select : str</span>
<span class="sd">            Not used in current implementation.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: must resurrect this for inhibitory synapses.</span>
        <span class="c1"># (and move constants out to their respective synapse locations)</span>
        <span class="c1">#elif psdtype.startswith(&#39;gly&#39;):</span>
            <span class="c1">#self.setDF(target_cell, &#39;ipsc&#39;, select) # set the parameters for release</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDF</span><span class="p">(</span><span class="n">target_cell</span><span class="p">,</span> <span class="s1">&#39;epsc&#39;</span><span class="p">)</span> <span class="c1"># set the parameters for release</span></div>
        

    <span class="c1">################################################################################</span>
    <span class="c1"># The following routines set the synapse dynamics, based on measurements and fit</span>
    <span class="c1"># to the DKR model.</span>
    <span class="c1">################################################################################</span>

<div class="viewcode-block" id="StochasticTerminal.setDF"><a class="viewcode-back" href="../../../synapses.html#cnmodel.synapses.stochastic_terminal.StochasticTerminal.setDF">[docs]</a>    <span class="k">def</span> <span class="nf">setDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_cell</span><span class="p">,</span> <span class="n">synapsetype</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the facilitation/depression parameters for the multisite release model.</span>
<span class="sd">        The parameters used here were obtained from an optimized fit of the DKR</span>
<span class="sd">        model to stimulus and recovery data for the auditory nerve synapses onto bushy</span>
<span class="sd">        and T-stellate cells at 100, 200 and 300 Hz (simultaneous fitting), for times out to about</span>
<span class="sd">        0.5 - 1.0 second. Data were collected by Dr. Ruili Xie and Dr. Yong Wang.</span>
<span class="sd">        Fitting by Paul Manis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        target_cell : :obj:`NEURON section`</span>
<span class="sd">            Define the target cell so that the correct release kinetics are used</span>
<span class="sd">        </span>
<span class="sd">        synapsetype : str</span>
<span class="sd">            String defining the type of synapse: &#39;ipsc&#39; or &#39;epsc&#39;</span>
<span class="sd">        </span>
<span class="sd">        select : str (default: None)</span>
<span class="sd">            Select kinetcs from a particular example cell.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">cells</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target_cell</span><span class="p">,</span> <span class="n">cells</span><span class="o">.</span><span class="n">Bushy</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">synapsetype</span> <span class="o">==</span> <span class="s1">&#39;ipsc&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">select</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">bushy_ipsc_average</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">bushy_ipsc_single</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="n">select</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target_cell</span><span class="p">,</span> <span class="n">cells</span><span class="o">.</span><span class="n">TStellate</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">synapsetype</span> <span class="o">==</span> <span class="s1">&#39;ipsc&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stellate_ipsc</span><span class="p">()</span></div>

<div class="viewcode-block" id="StochasticTerminal.set_params"><a class="viewcode-back" href="../../../synapses.html#cnmodel.synapses.stochastic_terminal.StochasticTerminal.set_params">[docs]</a>    <span class="k">def</span> <span class="nf">set_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set arbitrary parameters on the release mechanism.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        \**params : dict</span>
<span class="sd">            dictionary of parameters to set on the release mechanism.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span></div>

<div class="viewcode-block" id="StochasticTerminal.stellate_ipsc"><a class="viewcode-back" href="../../../synapses.html#cnmodel.synapses.stochastic_terminal.StochasticTerminal.stellate_ipsc">[docs]</a>    <span class="k">def</span> <span class="nf">stellate_ipsc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Facilitation/Depression parameters for DKR model for IPSCs onto stellate cells.</span>
<span class="sd">        IPSCs were derived from stimulation of the dorsal cochlear nucleus, and so represent</span>
<span class="sd">        the glycinergic synapses from tuberculoventral neurons.</span>
<span class="sd">        Data is average of 3 cells studied with recovery curves and individually fit, at 100 Hz.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">F</span> <span class="o">=</span> <span class="mf">0.23047</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">k0</span> <span class="o">=</span> <span class="mf">1.23636</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kmax</span> <span class="o">=</span> <span class="mf">45.34474</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">taud</span> <span class="o">=</span> <span class="mf">98.09</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kd</span> <span class="o">=</span> <span class="mf">0.01183</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">taus</span> <span class="o">=</span> <span class="mf">17614.50</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="mf">17.88618</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kf</span> <span class="o">=</span> <span class="mf">19.11424</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">tauf</span> <span class="o">=</span> <span class="mf">32.28</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">dD</span> <span class="o">=</span> <span class="mf">2.52072</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">dF</span> <span class="o">=</span> <span class="mf">2.33317</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">glu</span> <span class="o">=</span> <span class="mf">3.06948</span></div>

<div class="viewcode-block" id="StochasticTerminal.bushy_ipsc_average"><a class="viewcode-back" href="../../../synapses.html#cnmodel.synapses.stochastic_terminal.StochasticTerminal.bushy_ipsc_average">[docs]</a>    <span class="k">def</span> <span class="nf">bushy_ipsc_average</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Facilitation/Depression parameters for DKR model for IPSCs onto bushy cells.</span>
<span class="sd">        IPSCs were derived from stimulation of the dorsal cochlear nucleus, and so represent</span>
<span class="sd">        the glycinergic synapses from tuberculoventral neurons.</span>
<span class="sd">        Data for the kinetcs are the average of 16 bushy cells.</span>
<span class="sd">        The individual fits were compiled, and an average computed for just the 100 Hz data</span>
<span class="sd">        across the individual fits. This average was then fit to the DKR model</span>
<span class="sd">        (also see Matthew Xu-Friedman&#39;s papers). </span>
<span class="sd">        The individual cells show a great deal of variability, from straight depression, to </span>
<span class="sd">        mixed depression/facilitaiton, to facilation alone. This set of parameters generates</span>
<span class="sd">        a weak facilitation followed by depression back to baseline.</span>
<span class="sd">        </span>
<span class="sd">        There are other data sets in the source that are commented out.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#print &quot;USING average kinetics for Bushy IPSCs&quot;</span>

        <span class="c1"># average of 16cells for 100 Hz (to model); no recovery.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">F</span> <span class="o">=</span> <span class="mf">0.18521</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">k0</span> <span class="o">=</span> <span class="mf">2.29700</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kmax</span> <span class="o">=</span> <span class="mf">27.6667</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">taud</span> <span class="o">=</span> <span class="mf">0.12366</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kd</span> <span class="o">=</span> <span class="mf">0.12272</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">taus</span> <span class="o">=</span> <span class="mf">9.59624</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="mf">8.854469</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kf</span> <span class="o">=</span> <span class="mf">5.70771</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">tauf</span> <span class="o">=</span> <span class="mf">0.37752</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">dD</span> <span class="o">=</span> <span class="mf">4.00335</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">dF</span> <span class="o">=</span> <span class="mf">0.72605</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">glu</span> <span class="o">=</span> <span class="mf">5.61985</span></div>


<div class="viewcode-block" id="StochasticTerminal.bushy_ipsc_single"><a class="viewcode-back" href="../../../synapses.html#cnmodel.synapses.stochastic_terminal.StochasticTerminal.bushy_ipsc_single">[docs]</a>    <span class="k">def</span> <span class="nf">bushy_ipsc_single</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Facilitation/Depression parameters for DKR model for IPSCs onto 3 individual bushy cells.</span>
<span class="sd">        IPSCs were derived from stimulation of the dorsal cochlear nucleus, and so represent</span>
<span class="sd">        the glycinergic synapses from tuberculoventral neurons.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        select : int, default=None</span>
<span class="sd">            select which cell&#39;s measured kinetics will be used:</span>
<span class="sd">        </span>
<span class="sd">            0: Use average </span>
<span class="sd">            1: use data from 30aug08f</span>
<span class="sd">            2: select = 2, use data from 30aug08h</span>
<span class="sd">            3: select = 3, use data from 31aug08b (single cell, clean dataset)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
       <span class="c1"># print &quot;Using bushy ipsc&quot;</span>

        <span class="k">if</span> <span class="n">select</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">select</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="ow">or</span> <span class="n">select</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bushy_ipsc_average</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">select</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># 30aug08f</span>
<span class="c1">#            print &quot;using 30aug08f ipsc&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">F</span> <span class="o">=</span> <span class="mf">0.221818</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">k0</span> <span class="o">=</span> <span class="mf">0.003636364</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kmax</span> <span class="o">=</span> <span class="mf">0.077562107</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">taud</span> <span class="o">=</span> <span class="mf">0.300000</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kd</span> <span class="o">=</span> <span class="mf">1.112554</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">taus</span> <span class="o">=</span> <span class="mf">3.500000</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="mf">0.600000</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kf</span> <span class="o">=</span> <span class="mf">3.730452</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">tauf</span> <span class="o">=</span> <span class="mf">0.592129</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">dD</span> <span class="o">=</span> <span class="mf">0.755537</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">dF</span> <span class="o">=</span> <span class="mf">2.931578</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">glu</span> <span class="o">=</span> <span class="mf">1.000000</span>

        <span class="k">if</span> <span class="n">select</span> <span class="ow">is</span> <span class="mi">2</span><span class="p">:</span> <span class="c1">#30aug08h</span>
<span class="c1">#            print &quot;using 30aug08H ipsc&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">F</span> <span class="o">=</span> <span class="mf">0.239404</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">k0</span> <span class="o">=</span> <span class="mf">3.636364</span> <span class="o">/</span> <span class="mf">1000.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kmax</span> <span class="o">=</span> <span class="mf">16.725479</span> <span class="o">/</span> <span class="mf">1000.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">taud</span> <span class="o">=</span> <span class="mf">0.137832</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kd</span> <span class="o">=</span> <span class="mf">0.000900</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">taus</span> <span class="o">=</span> <span class="mf">3.500000</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="mf">0.600000</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kf</span> <span class="o">=</span> <span class="mf">4.311995</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">tauf</span> <span class="o">=</span> <span class="mf">0.014630</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">dD</span> <span class="o">=</span> <span class="mf">3.326148</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">dF</span> <span class="o">=</span> <span class="mf">0.725512</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">glu</span> <span class="o">=</span> <span class="mf">1.000000</span>

        <span class="k">if</span> <span class="n">select</span> <span class="ow">is</span> <span class="mi">3</span><span class="p">:</span>
<span class="c1">#            print &quot;using IPSC#3 &quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">F</span> <span class="o">=</span> <span class="mf">0.29594</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">k0</span> <span class="o">=</span> <span class="mf">0.44388</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kmax</span> <span class="o">=</span> <span class="mf">15.11385</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">taud</span> <span class="o">=</span> <span class="mf">0.00260</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kd</span> <span class="o">=</span> <span class="mf">0.00090</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">taus</span> <span class="o">=</span> <span class="mf">11.40577</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">ks</span> <span class="o">=</span> <span class="mf">27.98783</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">kf</span> <span class="o">=</span> <span class="mf">30.00000</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">tauf</span> <span class="o">=</span> <span class="mf">0.29853</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">dD</span> <span class="o">=</span> <span class="mf">3.70000</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">dF</span> <span class="o">=</span> <span class="mf">2.71163</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relsite</span><span class="o">.</span><span class="n">glu</span> <span class="o">=</span> <span class="mf">4.97494</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">CNModel 0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, 2018, Paul B. Manis and Luke Campagnola.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.2.
    </div>
  </body>
</html>